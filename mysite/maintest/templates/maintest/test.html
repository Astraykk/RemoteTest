<!DOCTYPE html>
<html lang="zh-CN">
</head>
  {% load static %}
  <meta charset="utf-8">
  <title>Test App in Bootstrap!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/javascript" src="{% static 'maintest/js/jquery.js' %}"></script>
  <link rel="stylesheet" href="{% static 'maintest/bootstrap/css/bootstrap.css' %}">
  <script type="text/javascript" src="{% static 'maintest/bootstrap/js/bootstrap.min.js' %}"></script>



  <script type="text/javascript" src="{% static 'maintest/js/bootstrap-treeview.js' %}"></script>
<script src="{% static 'maintest/WaveDrawJS/script/loadjson.js' %}"></script>
<script src="{% static 'maintest/WaveDrawJS/script/miscscript.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'maintest/css/bootstrap-treeview.css' %}">

  <script type="text/javascript" src="{% static 'maintest/js/maintest_js.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'maintest/css/maintest.css' %}">
  <script>
    // define django template tag variables
    var build_url = "{% url 'maintest:build' %}";
    var check_url = "{% url 'maintest:check' %}";
    var test_url = "{% url 'maintest:test' %}";
    var tv_ajax_url = "{% url 'maintest:tv_ajax' %}";
    var vcd2pic_url = "{% url 'maintest:vcd2picjson' %}";
    var uservcdfile = "{{ file_path }}";
  </script>
  <script>
    var currentTVPath = "{{current_path}}";  //fecth views.Maintest.directory

    $(document).ready(function()
    {
      $("#typical-test").click(function()  //to delete
      {
        html = '<form>Location:<input type="text" id="t-p-path"></form>';
        $("#s-p-body").html(html);
      });
      $("#submit-t-p-path").click(function() //submit path to be opened
      {
        currentTVPath = $('#t-p-path').val();
    changeWorkDir('successfully create project. moving to new page.');
      });
      $("#refresh_tree").click(function()  //refresh the file tree
      {
        loadTreeview(currentTVPath);
      });
    });
  </script>
  <script>  //unfinished
    $(document).ready(function(){
      $(".expand-icon").click(function(){
        alert('todo');
      });
    });
  </script>
  <script>
    $(document).ready(function(){
      $("#submit-edit-text").click(function(){
        console.log('start editing file');
        var text = $("#edit-text").val();
        var data = {
          text: text,
          path: "{{file_path}}"
        };
        $.ajax({
          type: 'POST',
          url: "{% url 'maintest:save_file' %}",
          data: data,
          success: function(data){
            console.log(data);
            if(data == 'Success!')
              alert("修改成功!");
            else
              alert("修改失败QAQ!\n" + data);
          }
        });
      });
    });

    function uploadFile(path){
      window.location.href = "{% url 'files:browse' %}?dir=" + path;
    }
  </script>
  <script>
    // FOR STUDY

  </script>
</head>

<body>
<div class="page-header">
  <h1>&nbsp;Chip-Test App
    <small>testing</small>
  </h1>
</div>
<div class="container">
  <div class="row">
    <div class="col-md-3">
      <!--<nav class="navbar navbar-default nav-expand" role="navigation" >-->
      <!--<div class="container-fluid">-->
      <!--<div class="navbar-header">-->
      <!--&lt;!&ndash;<button type="button" class="navbar-toggler">&ndash;&gt;-->
      <!--<button type="button" class="navbar-toggler" data-toggle="collapse"-->
      <!--data-target="#example-navbar-collapse" aria-controls="example-navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">-->
      <!--<span class="caret"></span>-->
      <!--</button>-->
      <!--<a class="navbar-brand" href="#">菜鸟教程</a>-->
      <!--</div>-->
      <!--<div class="collapse" id="example-navbar-collapse">-->
      <!--<ul class="nav navbar-nav">-->
      <!--<li><a href="#">iOS</a></li>-->
      <!--<li><a href="#">SVN</a></li>-->
      <!--<li class="dropdown">-->
      <!--<a href="#" class="dropdown-toggle" data-toggle="dropdown">-->
      <!--Java <b class="caret"></b>-->
      <!--</a>-->
      <!--<ul class="dropdown-menu">-->
      <!--<li><a href="#">jmeter</a></li>-->
      <!--<li><a href="#">EJB</a></li>-->
      <!--<li><a href="#">Jasper Report</a></li>-->
      <!--<li class="divider"></li>-->
      <!--<li><a href="#">分离的链接</a></li>-->
      <!--<li class="divider"></li>-->
      <!--<li><a href="#">另一个分离的链接</a></li>-->
      <!--</ul>-->
      <!--</li>-->
      <!--</ul>-->
      <!--</div>-->
      <!--</div>-->
      <!--</nav>-->
    </div>
    <div class="col-md-9">
      <div class="col-md-8">
        <!--Toolbar-->
        {% include "maintest/include/toolbar.html" %}
      </div>
      <div class="col-md-4">
        <!--Search bar-->
        <div class="input-group">
          <input type="text" class="form-control">
          <span class="input-group-btn">
                        <button class="btn btn-default" type="button">Search!</button>
                    </span>
        </div><!-- /input-group -->
      </div><!-- /.col-lg-6 -->
    </div>
  </div>
  <br>

  <div class="row">
    <div class="col-md-3"
         style="background-color: #dedef8;box-shadow:
                   inset 1px -1px 1px #444, inset -1px 1px 1px #444;">
      <h4>tool window</h4>
      <div class="row">
        <div class="col-md-12"
             style="background-color: #dedef8;box-shadow:
                           inset 1px -1px 1px #444, inset -1px 1px 1px #444;">
          <p>file tree</p>
          <div id="tree"></div>
          <a onclick="uploadFile(currentTVPath)" class="btn btn-default">
            upload <span class="glyphicon glyphicon-upload"></span>
          </a>
          <button id="refresh_tree" type="button" class="btn btn-default">
            refresh <span class="glyphicon glyphicon-refresh"></span>
          </button>
          <br><br>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12"
             style="background-color: #dedef8;box-shadow:
                           inset 1px -1px 1px #444, inset -1px 1px 1px #444;">
          <p>stream</p>
          {% include "maintest/include/stream_status.html" %}
        </div>
      </div>
    </div>
    <div class="col-md-9"
         style="background-color: #dedef8;box-shadow:
                   inset 1px -1px 1px #444, inset -1px 1px 1px #444;">
      <!--load the selected file an edit it here-->
      <div class="row">
        <div class="col-md-12"
             style="background-color: #dedef8;box-shadow:
                           inset 1px -1px 1px #444, inset -1px 1px 1px #444;padding:10px;">
          <!--<form role="form" action="{% url 'maintest:test' %}" method="post">-->
          <!--<form role="form" method="post">-->
            <!--{% csrf_token %}-->
            <!--<div class="form-group">-->
              <label for="name">edit area</label>
              <!--<input type="text" class="form-control" id="name" placeholder="selected file">-->
              <textarea id="edit-text" class="form-control" rows="10">{{ file_content }}</textarea>
            <!--</div>-->
            <button id="submit-edit-text" type="submit" class="btn btn-default">submit</button>
          <!--</form>-->
          <br>
        </div>
      </div>
      
      <div class="row">
          <h4>Waveform</h4>
        <div class='wavedrawing-'>
          <div>
            <button id="wave-draw" class="btn btn-default">Reload Image</button>
          </div>
          <div class="wavedrawing-container">
            <div id="namel-"><li id="wavedrawing-heading">Signals</li><ul class="inner-list"></ul></div><!--用注释去除空白
         --><div id='column-sep'> </div><!--用注释去除空白
         --><div id="canvasl-"><canvas id="wavedraw-gridc"></canvas><ul class="inner-list"></ul></div>
          </div>
          <p class='.timebar'>Now showing <span></span> to <span></span>.</p>
          <p>propotion<input id="propotion-" type="range" min="0" max="1000" value="1000"></p>
          <p>width<input id="width-" type="range" min="0" max="1000" value="1000"></p>
          <input type="radio" name="mode" value="0">observe
          <input type="radio" name="mode" value="1">control
        <script src="{% static 'maintest/WaveDrawJS/script/utils.js' %}"></script>
        <script src="{% static 'maintest/WaveDrawJS/script/draw.js' %}"></script>
        <script src="{% static 'maintest/WaveDrawJS/script/controller.js' %}"></script>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
   generateFileTree({{obj|safe}});
   treeviewOpenProject({{tv_dir|safe}});
   // waveform_path = "{% static 'maintest/img/' %}{{ current_path }}/";
</script>
<script>
$(function() {
    $('#strat-project-modal').modal('hide')
});
</script>
</body>
</html>
